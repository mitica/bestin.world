---
import BestWorstCountries from "../components/BestWorstCountries.astro";
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

const [countryInsights, countries] = await Promise.all([
  getCollection("countryInsights"),
  getCollection("countries").then((countries) =>
    countries.map((country) => country.data)
  )
]);
const insights = countryInsights
  .map((insight) =>
    insight.data.map((it) => ({
      ...it,
      countryId: insight.id
    }))
  )
  .flat();
---

<Layout title={"Exceptional Countries"}>
  <div class="flex flex-col gap-4">
    <div>
      <h2 class="text-center">Exceptional Countries</h2>
      <p class="text-center text-gray-500 text-sm">
        Exploring the best and worst performers across global indicators
      </p>
    </div>
    <BestWorstCountries insights={insights} countries={countries} />
  </div>
</Layout>
